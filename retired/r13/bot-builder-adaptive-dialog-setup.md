---
title: Create a bot project for adaptive dialogs - Bot Service
description: Learn how to create a project to which you can add adaptive dialogs in the Bot Framework SDK.
keywords: declarative, adaptive
author: JonathanFingold
ms.author: kamrani
manager: kamrani
ms.topic: article
ms.service: bot-service
ms.date: 08/18/2020
monikerRange: 'azure-bot-service-4.0'
---

# Create a bot project for adaptive dialogs Â 

[!INCLUDE [applies-to-v4](../includes/applies-to-v4-current.md)]

If you want to write an adaptive dialog from scratch or consume a dialog that was authored in the Bot Framework Composer, you will need certain scaffolding in place that is not required for other types of bot projects.

This article shows how to create a C# bot project, starting from an **empty bot** template. You can later add adaptive dialogs, including declarative dialogs generated by Composer.

## Prerequisites

- Visual Studio 2019 or later or Visual Studio Code.
- A conceptual understanding of [adaptive dialogs](bot-builder-adaptive-dialog-Introduction.md).
- For sample code, this article references the adaptive **multi-turn prompt** sample in [**C#**](https://aka.ms/cs-adaptive-multi-turn-sample).

## Create the project

For information on how to create a bot project, see the [C# quickstart](../dotnet/bot-builder-dotnet-sdk-quickstart.md#templates).

1. Update your copy of the Bot Framework templates (VSIX or .NET Core) to the latest version.
1. Create a new project based on the **empty bot** .NET Core 3.1 template.

> [!NOTE]
> This article does not highlight the using statements you need to add to get the project to compile.

## Add NuGet packages

1. Open your project in your preferred IDE.
1. Add the **Microsoft.Bot.Builder.Dialogs.Adaptive** 4.10.0 or later NuGet package as a dependency.
1. Register any additional packages your bot will need:
    - For adaptive dialog unit testing, add the **Microsoft.Bot.Builder.Dialogs.Adaptive.Testing** package.
    - For LUIS language understanding, add the **Microsoft.Bot.Builder.AI.LUIS** package.
    - For QnA Maker language understanding, add the **Microsoft.Bot.Builder.AI.QnA** package.

If your bot consumes custom components, it may require additional packages. The author of each custom component should clearly state which packages are required.

## Register components

To support customization, the adaptive dialogs library uses component registration to discover all components, declarative types, memory scopes, path resolvers, and type converters.

Register adaptive and declarative components as necessary in the `ConfigureServices` method for your project.

| Required | Description | Component registration
| :--- | :--- | :---
| Required | Components common to all adaptive dialogs. | `ComponentRegistration.Add(new AdaptiveComponentRegistration());`
| Required | Common memory scopes and path resolvers. | `ComponentRegistration.Add(new DialogsComponentRegistration());`
| Optional | Components used to unit test adaptive dialogs. | `ComponentRegistration.Add(new AdaptiveTestingComponentRegistration());`
| Optional | Components used to consume declarative dialogs. | `ComponentRegistration.Add(new DeclarativeComponentRegistration());`
| Optional | Components used for language generation features.| `ComponentRegistration.Add(new LanguageGenerationComponentRegistration());`
| Optional | Components used for LUIS (language understanding) features. | `ComponentRegistration.Add(new LuisComponentRegistration());`
| Optional | Components used for QnA Maker (language understanding) features. | `ComponentRegistration.Add(new QnAMakerComponentRegistration());`
| Optional | Components specific to the Teams channel. | `ComponentRegistration.Add(new TeamsComponentRegistration());`

If your project does not register a component that is required by another part of your bot, you can add it later, but you may get an initialization-time or run-time error.

> [!NOTE]
> If your bot consumes custom components, you will need to register those components, too. The author of each custom component should clearly state which method to use to register their components.

**startup.cs**

For example, the adaptive multi-turn prompts sample registers these components in `ConfigureServices`.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/Startup.cs" range="24-31":::

## Add state

As with other bots, you still need to create the storage layer and state management objects.

You will use the dialog manager to run your adaptive dialogs, and it will need references to the storage layer and user and conversation state objects. (It needs these to set up memory scopes.) While you can add these directly to the dialog manager, the dialog manager will discover these if they are registered properly on the turn context.

**startup.cs**

You will be updating the adapter to consume an `ICredentialProvider`, so you need to register one in `ConfigureServices`.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/Startup.cs" range="33-34":::

Also register the storage layer and state management objects your bot will use in `ConfigureServices`.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/Startup.cs" range="39-46":::

**AdapterWithErrorHandler.cs**

In C#, you can use the adapter's `UseStorage` and `UseBotState` methods to add references to the storage and state management objects to the turn context each turn.

Modify the signature for the existing adapter constructor.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/AdapterWithErrorHandler.cs" range="17-19":::

Add the calls to the UseStorage and UseBotState methods before setting the adapter's OnTurnError property.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/AdapterWithErrorHandler.cs" range="21-25":::

## Add an adaptive dialog

Create a **Dialogs** folder and then create the root dialog your bot will use.

**Dialogs\\RootDialog.cs**

Create a root dialog class. The sample defines a `RootDialog` to use.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/Dialogs/RootDialog.cs" range="15-18,38,134":::

At this point the dialog won't yet respond to the user. You can add a trigger to the dialog (in the constructor) to let it respond. Here is a sample trigger.

```csharp
Triggers = new List<OnCondition>
{
    new OnUnknownIntent
    {
        Actions =
        {
            new SendActivity("Hi, we are up and running!!"),
        }
    },
};
```

**startup.cs**

The sample registers the root dialog in the startup file in `ConfigureServices`.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/Startup.cs" range="48-49":::

## Add a dialog manager

Much as you would with other dialog-based bots, design the bot class to take a dialog as a constructor parameter. However, create and use a dialog manager to run the root dialog.

In the adaptive mutli-turn prompts sample, the root dialog is an adaptive dialog. The dialog manager can be used to run any type dialog, but it is required if the root dialog or any of its children are adaptive dialogs.

**DialogBot.cs**

Rename the default **EmptyBot** class and file to **DialogBot**.

The sample defines the bot and adds code to create and use a dialog manager to run the root dialog each turn. The dialog manager will forward all activities to the dialog. In the multi-turn prompt sample, this file is **Bots\\DialogBot.cs**.

Replace the existing class definition with this code. (If you do not include the `using Microsoft.Extensions.Logging;` statement, the `ILogger` reference is ambiguous.)

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/Bots/DialogBot.cs" range="8-9,17-36":::

**startup.cs**

The sample registers the bot object in the startup file in `ConfigureServices`. Replace the call to register your bot class (`services.AddTransient<IBot, EmptyBot>();`) with this code.

:::code language="csharp" source="~/../botbuilder-samples/samples/csharp_dotnetcore/adaptive-dialog/01.multi-turn-prompt/Startup.cs" range="51-52":::

## Compile and test

At this point your bot should compile and run. You can test it in the Emulator. If your root adaptive dialog doesn't define any triggers or actions, the bot will not reply to input, but you should get HTTP 200 status responses back from the bot.

## Additional information

Adaptive dialogs are a powerful tool and have many ways in which they can be customized and extended. See the following articles for more information.

- [Adaptive expressions](bot-builder-concept-adaptive-expressions.md)
- [Language generation](bot-builder-concept-language-generation.md) and [generators](bot-builder-concept-adaptive-dialog-generators.md)
- [Events and triggers](bot-builder-concept-adaptive-dialog-Triggers.md)
- [Actions](bot-builder-concept-adaptive-dialog-actions.md) and [inputs](bot-builder-concept-adaptive-dialog-inputs.md)
- [Recognizers](bot-builder-concept-adaptive-dialog-recognizers.md)
  - [What is LUIS](/azure/cognitive-services/luis/what-is-luis)
  - [What is QnA Maker](/azure/cognitive-services/qnamaker/overview/overview)
- [Memory scopes and paths](bot-builder-concept-adaptive-dialog-memory-states.md)
- [Declarative dialogs](bot-builder-concept-adaptive-dialog-declarative.md) and type converters
  - [Creating a schema file](bot-builder-dialogs-declarative.md#creating-the-schema-file)

<!-- Add Custom components: actions, triggers, dialogs, recognizers, and so on to the list, once they are available.-->

## Next steps

> [!div class="nextstepaction"]
> [Create a bot using adaptive dialogs](bot-builder-dialogs-adaptive.md)
