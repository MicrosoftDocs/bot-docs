In this step, you create a bot application service which sets the deployment stage for the bot. When using an existing resource group, you can either use an existing app service plan or create a new one. Choose the option that works best for you:

- [**Option 1: Existing App Service Plan**](#option-1-existing-app-service-plan)
- [**Option 2: New App Service Plan**](#option-2-new-app-service-plan)

> [!NOTE]
> This step can take a few minutes to complete.

##### **Option 1: Existing App Service Plan**

In this case, we are using an existing App Service Plan, but creating a new Web App and Bot Channels Registration.

This command below sets the bot's ID and display name. The `botId` parameter should be globally unique and is used as the immutable bot ID. The bot's display name is mutable.

```azurecli
az deployment group create --resource-group "<name-of-resource-group>" --template-file "<path-to-template-with-preexisting-rg.json>" --parameters appId="<app-id-from-previous-step>" appSecret="<password-from-previous-step>" botId="<id or bot-app-service-name>" newWebAppName="<bot-app-service-name>" existingAppServicePlan="<name-of-app-service-plan>" appServicePlanLocation="<region-location-name>" --name "<bot-app-service-name>"
```

##### **Option 2: New App Service Plan**

In this case, we are creating App Service Plan, Web App, and Bot Channels Registration.

```azurecli
az deployment group create --resource-group "<name-of-resource-group>" --template-file "<path-to-template-with-preexisting-rg.json>" --parameters appId="<app-id-from-previous-step>" appSecret="<password-from-previous-step>" botId="<id or bot-app-service-name>" newWebAppName="<bot-app-service-name>" newAppServicePlanName="<name-of-app-service-plan>" appServicePlanLocation="<region-location-name>" --name "<bot-app-service-name>"
```

| Option   | Description |
|:---------|:------------|
| name | The deployment name.|
| resource-group | Name of the azure resource group. |
| template-file | The path to the ARM template. Usually, the  `template-with-preexisting-rg.json` file is provided in the `deploymentTemplates` folder of the project. This is a path to an existing template file. It can be an absolute path, or relative to the current directory. All bot templates generate ARM template files.|
| location |Location. Values from: `az account list-locations`. You can configure the default location using `az configure --defaults location=<location>`. |
| parameters | Deployment parameters, provided as a list of key=value pairs. Enter the following parameter values:

- `appId` - The `appId` value generated by the [3.1 create the application registration](../../bot-builder-deploy-az-cli.md#3-create-the-application-registration) step.
- `appSecret` - The password you provided in the the [3.1 create the application registration](../../bot-builder-deploy-az-cli.md#3-create-the-application-registration) step.
- `botId` - A name for the  Bot Channels Registration resource to create. It must be globally unique. It is used as the immutable bot ID. It is also used as the default display name, which is mutable.
- `newWebAppName` - A name for the bot application service.
- `newAppServicePlanName` - A name for the application service plan resource to create.
- `appServicePlanLocation` - The location of the application service plan.
