---
title: How bot projects are structured - Bot Service
description: Learn about how bot projects are structured in the Bot Framework SDK. Learn about common aspects of bot code.
author: JonathanFingold
ms.author: iawilt
manager: shellyha
ms.reviewer: micchow
ms.topic: how-to
ms.service: bot-service
ms.date: 06/06/2022
monikerRange: 'azure-bot-service-4.0'
---

# Understand the structure of an echo bot

[!INCLUDE [applies-to-v4](../includes/applies-to-v4-current.md)]

The Bot Framework templates and samples are written for ASP.NET (C#), restify (JavaScript), and aiohttp (Python).
However, the web service features are not part of the Bot Framework SDK, but part of the web framework you choose to use.

All bot applications share some common features.

| Feature | Description |
|:-|:-|
| Resource provisioning | The bot as a web app needs to create a web service, bot adapter, and bot object. |
| Messaging endpoint | The web app needs to implement a messaging endpoint on which to receive activities and forward activities to the bot adapter. |
| Bot adapter | The adapter receives activities from the messaging endpoint, forwards them to the bot's turn handler, and catches any errors or exceptions the bot's logic doesn't catch. |
| Bot object | The bot object handles the bot's reasoning or logic for the turn. |

You can create an echo bot from the templates, as described in [Create a bot](../bot-service-quickstart-create-bot.md), or you can copy an echo bot project from the [Microsoft/BotBuilder-Samples](https://github.com/Microsoft/BotBuilder-Samples) repository.

The C# and JavaScript templates have built-in support for streaming connections. However, this article doesn't cover streaming features. For information about streaming connections, see how to [connect a bot to Direct Line Speech](../bot-service-channel-connect-directlinespeech.md).

## Prerequisites

- Knowledge of [bot basics](bot-builder-basics.md).
- A copy of the **echo bot** sample in [**C#**](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/02.echo-bot#readme), [**JavaScript**](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/02.echo-bot#readme), [**Java**](https://github.com/microsoft/BotBuilder-Samples/tree/main/samples/java_springboot/02.echo-bot#readme), or [**Python**](https://github.com/microsoft/BotBuilder-Samples/tree/main/samples/python/02.echo-bot#readme).

## Bot templates

A bot is a web application, and templates are provided for each language.

# [C#](#tab/csharp)

The Bot Framework includes both VSIX and .NET templates.

The templates generate an [ASP.NET MVC Core](https://dotnet.microsoft.com/apps/aspnet/mvc) web app. If you look at the [ASP.NET](/aspnet/core/fundamentals/index?view=aspnetcore-3.1&preserve-view=true) fundamentals, you'll see similar code in files such as **Program.cs** and **Startup.cs**. These files are required for all web apps and are not bot-specific.

[!INCLUDE [VSIX templates](../includes/vsix-templates-versions.md)]

The **appsettings.json** file specifies the configuration information for your bot, such as its app ID, and password among other things. If using certain technologies or using this bot in production, you will need to add your specific keys or URL to this configuration. For this echo bot, however, you don't need to do anything here right now; the app ID and password may be left undefined at this time.

The **EchoBot.csproj** file specifies dependencies and their associated versions for your bot. This is all set up by the template and your system. Additional dependencies can be installed using NuGet package manager or the `dotnet add package` command.

# [JavaScript](#tab/javascript)

The Yeoman generator creates a type of [restify](http://restify.com/) web application. If you look at the restify quickstart in their docs, you'll see an app similar to the generated **index.js** file. Some of the key files generated by the template are described in this article. Code in some files won't be copied, but you will see it when you run the bot, and you can refer to the [Node.js echobot](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/02.echo-bot) sample.

The **package.json** file specifies dependencies and their associated versions for your bot. This is all set up by the template and your system. Additional dependencies can be installed using `npm install`.

The **.env** file specifies the configuration information for your bot, such as the port number, app ID, and password among other things. If using certain technologies or using this bot in production, you will need to add your specific keys or URL to this configuration. For this Echo bot, however, you don't need to do anything here right now; the app ID and password may be left undefined at this time.

To use the **.env** configuration file, the bot requires the `dotenv` package from npm. This is already included as a dependency in the **package.json** file.

# [Java](#tab/java)

The Yeoman generator creates a [Spring](https://spring.io/web-applications) based web application with a build file using [Maven](https://maven.apache.org/what-is-maven.html).

The Maven **pom.xml** file specifies dependencies and their associated versions for your bot. This is all set up by the template and your system. Additional dependencies can be installed by adding entries to the pom.xml file.

The **application.properties** file specifies the configuration information for your bot, such as the port number, app ID, and password among other things. If using certain technologies or using this bot in production, you will need to add your specific keys or URL to this configuration. For this Echo bot, however, you don't need to do anything here right now; the app ID and password may be left undefined at this time.

# [Python](#tab/python)

The Python Cookiecutter templates create an [aiohttp](https://docs.aiohttp.org/) web application.

The **requirements.txt** file specifies dependencies and their associated versions for your bot.  This is all setup by the template and your system. Additional dependencies can be installed using `pip install -r requirements.txt`

The **config.py** file specifies the configuration information for your bot, such as the port number, app ID, and password among other things. If using certain technologies or using this bot in production, you will need to add your specific keys or URL to this configuration. For this Echo bot, however, you don't need to do anything here right now; the app ID and password may be left undefined at this time.

---

## Resource provisioning

To function as a web app, your bot needs to create a web service, bot adapter, and bot object.

For most bots, you would also create storage layer and memory management objects for the bot.
However, the echo bot does not need to persist state between turns.
And for some bots, you may need to create other objects that the bot object or adapter will require.

### [C#](#tab/csharp)

In ASP.NET, you register objects and object creation methods in the **Startup.cs** file.
The `ConfigureServices` method loads the connected services, as well as their keys (if there are any) from **appsettings.json**, connects state, and so on. Here, the adapter and bot are defined to be available through dependency injection.
Then, the `Configure` method finishes the configuration of your app.

`ConfigureServices` and `Configure` are called by the runtime when the app starts.

### [JavaScript](#tab/javascript)

In restify, you set up the web service and the objects it needs in the **index.js** file. The service, adapter, and bot are covered separately in the following sections.

### [Java](#tab/java)

In Spring, you set up the web service and the objects it needs in the **application.java** file. The **application.java** has comments that denote the different components and framework classes used by the bot application. The service, adapter, and bot are covered separately in the following sections.

### [Python](#tab/python)

In aiohttp, you set up the web service and the objects it needs in the **app.py** file. The service, adapter, and bot are covered separately in the following sections.

---

## Messaging endpoint

The template implements a web service with a messaging endpoint.
When it receives a request, the service extracts the authentication header and request payload and forwards them to the adapter.

The C# and JavaScript SDKs support streaming connections. While the echo bot does not use any of the streaming features, the adapter in the C# and JavaScript templates is designed to support them.

Each incoming request represents the start of a new turn.

### [C#](#tab/csharp)

**Controllers\\BotController.cs**

[!code-csharp[BotController](~/../botbuilder-samples/samples/csharp_dotnetcore/02.echo-bot/Controllers/BotController.cs?range=11-34&highlight=22)]

### [JavaScript](#tab/javascript)

**index.js**

[!code-javascript[Create server](~/../botbuilder-samples/samples/javascript_nodejs/02.echo-bot/index.js?range=21-26)]

[!code-javascript[Listen for HTTP requests](~/../botbuilder-samples/samples/javascript_nodejs/02.echo-bot/index.js?range=74-78&highlight=4)]

### [Java](#tab/java)

**Application.java**

[!code-java[Application](~/../botbuilder-samples/samples/java_springboot/02.echo-bot/src/main/java/com/microsoft/bot/sample/echo/Application.java?range=27)]

### [Python](#tab/python)

**app.py**

[!code-python[create server](~/../botbuilder-samples/samples/python/02.echo-bot/app.py?range=64-88&highlight=12)]

---

## The bot adapter

The adapter receives activities from the messaging endpoint, forwards them to the bot's turn handler, and catches any errors or exceptions the bot's logic doesn't catch. The adapter also forwards activities from your bot to the user's channel.

The adapter allows you to add your own _on turn error_ handler.

### [C#](#tab/csharp)

**Startup.cs**

The adapter to use is defined in the `ConfigureServices` method.

[!code-csharp[adapter](~/../botbuilder-samples/samples/csharp_dotnetcore/02.echo-bot/Startup.cs?range=34-35)]

**AdapterWithErrorHandler.cs**

[!code-csharp[adapter](~/../botbuilder-samples/samples/csharp_dotnetcore/02.echo-bot/AdapterWithErrorHandler.cs?range=11-32)]

### [JavaScript](#tab/javascript)

**index.js**

[!code-javascript[create adapter](~/../botbuilder-samples/samples/javascript_nodejs/02.echo-bot/index.js?range=43-69)]

### [Java](#tab/java)

**Application.java**

The adapter to use is defined in the `getBotFrameworkAdapter` method.

[!code-java[adapter](~/../botbuilder-samples/samples/java_springboot/02.echo-bot/src/main/java/com/microsoft/bot/sample/echo/Application.java?range=55-64&highlight=9)]

The AdapterWithErrorHandler is defined in the Java SDK code, in the com.microsoft.bot.integration package. This class can be reviewed in the source code for the Java SDK.

### [Python](#tab/python)

**app.py**

[!code-python[create adapter](~/../botbuilder-samples/samples/python/02.echo-bot/app.py?range=11-15,22-28,30-56,58-59)]

---

## The bot logic

The echo bot uses an _activity handler_ and implements handlers for the activity types it recognizes and reacts to, in this case, the _conversation update_ and _message_ activities.

- A conversation update activity includes information on who has joined or left the conversation. For non-group conversations, both the bot and the user join the conversation when it starts. For group conversations, a conversation update is generated whenever someone joins or leaves the conversation, whether that's the bot or a user.
- A message activity represents a message the user sends to the bot.

The echo bot welcomes a user when they join the conversation and echoes back any messages they send to the bot.

### [C#](#tab/csharp)

**Startup.cs**

The bot to use is defined in the `ConfigureServices` method.

[!code-csharp[EchoBot](~/../botbuilder-samples/samples/csharp_dotnetcore/02.echo-bot/Startup.cs?range=37-38)]

**Bots\\EchoBot.cs**

[!code-csharp[adapter](~/../botbuilder-samples/samples/csharp_dotnetcore/02.echo-bot/Bots/EchoBot.cs?range=12-31)]

### [JavaScript](#tab/javascript)

**index.js**

[!code-javascript[create bot](~/../botbuilder-samples/samples/javascript_nodejs/02.echo-bot/index.js?range=21-22,70-72)]

**bot.js**

[!code-javascript[bot logic](~/../botbuilder-samples/samples/javascript_nodejs/02.echo-bot/bot.js?range=4-29)]

### [Java](#tab/java)

**Application.java**

The bot to use is defined in the `getBot` method.

[!code-java[adapter](~/../botbuilder-samples/samples/java_springboot/02.echo-bot/src/main/java/com/microsoft/bot/sample/echo/Application.java?range=40-53)]

**EchoBot.cs**

[!code-java[adapter](~/../botbuilder-samples/samples/java_springboot/02.echo-bot/src/main/java/com/microsoft/bot/sample/echo/EchoBot.java?range=25-47)]

### [Python](#tab/python)

**app.py**

[!code-python[create bot](~/../botbuilder-samples/samples/python/02.echo-bot/app.py?range=11-15,60-61)]

**bots/bot.py**

[!code-python[create bot](~/../botbuilder-samples/samples/python/02.echo-bot/bots/echo_bot.py?range=4-19)]

---

## Next steps

- Learn how to [send and receive text messages](bot-builder-howto-send-messages.md)
- Learn how to [send welcome messages to users](bot-builder-send-welcome-message.md)
